let type="";function $(e){return document.querySelector(e)}function snackbar(e){$("#snackbarMsg").innerText=e,$("#snackbar").style.bottom="20px",setTimeout(()=>{$("#snackbar").style.bottom="-48px"},4e3)}[].forEach.call(document.querySelectorAll(".memberCard"),e=>{if(e.dataset.id){let a=e.dataset.id,t=e.dataset.name,s=$(`#accept${a}`),d=$(`#fail${a}`),l=$(`#feedback${a}`);s.addEventListener("click",()=>{l.value?(type="pass",$("body").classList.add("inactive"),$("#txt").innerHTML=`Are you sure you would like to <b>APPROVE</b> ${t}'s portfolio?`,$("#dialog").dataset.student=a):(l.focus(),snackbar("You must provide feedback"))}),d.addEventListener("click",()=>{l.value?(type="fail",$("body").classList.add("inactive"),$("#txt").innerHTML=`Are you sure you would like to <b>DECLINE</b> ${t}'s portfolio?`,$("#dialog").dataset.student=a):(l.focus(),snackbar("You must provide feedback"))})}}),$("#newUser").addEventListener("click",()=>{$("body").classList.add("addStudent")}),$("#addMultiple").addEventListener("click",()=>{$("body").classList.add("addMultiple")}),$("#accept").addEventListener("click",()=>{let e=$("#dialog").dataset.student;console.log(e),AjaxRequest("includes/review.php",{active:type,feedback:$(`#feedback${e}`).value,userId:e}).then(a=>{if("Review sent"==a||"Portfolio passed"==a){type="",$("#dialog").dataset.student="-1",$("body").classList.remove("inactive");let t=$(`[data-id="${e}"]`);t.parentNode.removeChild(t),snackbar(a)}else snackbar(a)})}),$("#acceptNew").addEventListener("click",()=>{let e=$("#usernameNew").value,a=$("#firstNameNew").value,t=$("#lastNameNew").value,s=$("#emailNew").value,d=$("#r1"),l=$("#r2"),c=$("#r3");if(null==s||""==s)snackbar("Please fill in all the fields");else if(d.checked||l.checked||c.checked){let i="";d.checked&&(i=d.value),l.checked&&(i=l.value),c.checked&&(i=c.value),AjaxRequest("includes/addUser.php",{username:e,firstName:a,lastName:t,email:s,class:i}).then(e=>{"done"==e?(snackbar("Student added"),$("body").classList.remove("addStudent"),$("#usernameNew").value="",$("#firstNameNew").value="",$("#lastNameNew").value="",$("#emailNew").value="",d.checked=!1,l.checked=!1,c.checked=!1):snackbar(e)})}else snackbar("Please add a class")}),$("#acceptMultiple").addEventListener("click",()=>{let e=$("#multipleUpload");AjaxRequest("includes/addMultipleUsers.php",{file:e.files[0]}).then(a=>{if("done"==a)snackbar("Added multiple users"),$("body").classList.remove("addMultiple"),e.value="";else if("done-"==a.substring(0,5)){let e=a.substring(5);snackbar("These students failed to add: "+e.substring(0,e.length-1)+". Check the CSV file")}else snackbar(a)})}),$("#cancel").addEventListener("click",()=>{type="",$("body").classList.remove("inactive"),$("#dialog").dataset.student="-1"}),$("#cancelNew").addEventListener("click",()=>{$("body").classList.remove("addStudent"),$("#usernameNew").value="",$("#firstNameNew").value="",$("#lastNameNew").value="",$("#emailNew").value="",r1.checked=!1,r2.checked=!1,r3.checked=!1}),$("#cancelMultiple").addEventListener("click",()=>{$("body").classList.remove("addMultiple"),$("#multipleUpload").value=""});